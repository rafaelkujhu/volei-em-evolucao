<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V√¥lei em Evolu√ß√£o</title>

<style>
:root{
  --primary:#3f51b5;
  --bg:#f2f4f8;
  --card:#ffffff;
  --radius:14px;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:var(--bg);
}
.app{
  max-width:420px;
  margin:auto;
  min-height:100vh;
  padding:16px;
}
h1,h2{color:var(--primary);}
input,select{
  width:100%;
  padding:10px;
  height:42px;
  border-radius:10px;
  border:1px solid #dcdcdc;
  font-size:14px;
  margin-top:6px;
}
button{
  width:100%;
  padding:14px;
  margin-top:14px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:12px;
  font-size:15px;
}
.perfil{
  background:linear-gradient(135deg,#3f51b5,#5c6bc0);
  color:#fff;
  padding:12px;
  border-radius:14px;
  font-size:13px;
  line-height:1.5;
}
.card{
  background:#fff;
  padding:12px;
  border-radius:14px;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
  margin-top:12px;
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}
.progress{
  height:8px;
  background:#e0e4f5;
  border-radius:8px;
  overflow:hidden;
  margin-top:6px;
}
.progress-bar{height:100%;width:0%;}
.pb-red{background:#d32f2f;}
.pb-yellow{background:#f9a825;}
.pb-green{background:#388e3c;}
.meta{font-size:12px;margin-top:4px;}
canvas{margin-top:12px;background:#fff;border-radius:14px;}
.oculto{display:none;}
@media print{
  button,#login,#treinador{display:none;}
}
</style>
</head>

<body>
<div class="app">

<!-- LOGIN -->
<div id="login">
  <h1>üèê V√¥lei em Evolu√ß√£o</h1>
  <input id="nome" placeholder="Nome do atleta">
  <input id="idade" type="number" placeholder="Idade">
  <input id="altura" type="number" step="0.01" placeholder="Altura (m)">
  <input id="peso" type="number" step="0.1" placeholder="Peso (kg)">
  <input id="quadril" type="number" step="0.1" placeholder="Quadril (cm)">
  <select id="posicao">
    <option value="">Posi√ß√£o</option>
    <option>Levantador(a)</option>
    <option>Ponteiro(a)</option>
    <option>Central</option>
    <option>Oposto(a)</option>
    <option>L√≠bero</option>
  </select>
  <button onclick="entrar()">Entrar como atleta</button>
  <button onclick="abrirTreinador()">Entrar como treinador</button>
</div>

<!-- APP ATLETA -->
<div id="app" class="oculto">
  <div class="perfil" id="perfil"></div>

  <h2>Fundamentos</h2>
  <div id="fundamentos"></div>

  <button onclick="analisar()">Analisar sess√£o</button>
  <div id="saida"></div>

  <canvas id="grafico" width="360" height="180"></canvas>

  <button onclick="gerarPDF()">üìÑ PDF pedag√≥gico</button>
  <button onclick="sair()">Sair</button>
</div>

<!-- TREINADOR -->
<div id="treinador" class="oculto">
  <h2>Modo treinador</h2>
  <div id="listaAtletas"></div>
  <canvas id="graficoAtleta" width="360" height="180"></canvas>
  <button onclick="voltarLogin()">Voltar</button>
</div>

</div>

<script>
let atletaAtual=null;
const fundamentosLista=["Saque","Passe","Ataque","Defesa"];
const fundamentosEl=document.getElementById("fundamentos");

/* ===== METAS POR IDADE ===== */
function faixaEtaria(i){return i<=12?"infantil":i<=15?"juvenil":"adulto";}
const metas={
  infantil:{Saque:50,Passe:60,Ataque:50,Defesa:60},
  juvenil:{Saque:60,Passe:70,Ataque:65,Defesa:70},
  adulto:{Saque:70,Passe:80,Ataque:75,Defesa:75}
};
const treinos={
  infantil:{Saque:["Alvo grande","Controle"],Passe:["Passe parado"],Ataque:["Sem salto"],Defesa:["Base"]},
  juvenil:{Saque:["Direcionado"],Passe:["Movimento"],Ataque:["Tempo"],Defesa:["Transi√ß√£o"]},
  adulto:{Saque:["T√°tico"],Passe:["Press√£o"],Ataque:["Varia√ß√£o"],Defesa:["Leitura"]}
};

/* ===== LOGIN ===== */
function entrar(){
  if(!nome.value.trim()) return alert("Informe o nome");
  atletaAtual=nome.value.trim();
  let atleta={
    perfil:{
      nome:atletaAtual,
      idade:+idade.value||0,
      posicao:posicao.value,
      altura:+altura.value||0,
      peso:+peso.value||0,
      quadril:+quadril.value||0
    },
    sessoes:[]
  };
  localStorage.setItem(atletaAtual,JSON.stringify(atleta));
  login.classList.add("oculto");
  app.classList.remove("oculto");
  carregarPerfil();
  montarFundamentos();
}

/* ===== PERFIL ===== */
function carregarPerfil(){
  let a=JSON.parse(localStorage.getItem(atletaAtual));
  let imc=(a.perfil.peso/(a.perfil.altura**2)).toFixed(1);
  let iac=((a.perfil.quadril/(a.perfil.altura*Math.sqrt(a.perfil.altura)))-18).toFixed(1);
  perfil.innerHTML=`<strong>${a.perfil.nome}</strong><br>
  ${a.perfil.posicao} ¬∑ ${a.perfil.idade} anos<br>
  IMC: ${imc} ¬∑ IAC: ${iac}`;
}

/* ===== FUNDAMENTOS ===== */
function montarFundamentos(){
  let html="";
  fundamentosLista.forEach(f=>{
    html+=`
    <div class="card">
      <strong>${f}</strong>
      <div class="grid">
        <input id="${f}A" type="number" placeholder="Acertos">
        <input id="${f}E" type="number" placeholder="Erros">
      </div>
      <div class="progress"><div id="bar${f}" class="progress-bar"></div></div>
      <div id="meta${f}" class="meta"></div>
    </div>`;
  });
  fundamentosEl.innerHTML=html;
}

/* ===== AN√ÅLISE ===== */
function analisar(){
  let atleta=JSON.parse(localStorage.getItem(atletaAtual));
  let faixa=faixaEtaria(atleta.perfil.idade);
  let dados={};

  fundamentosLista.forEach(f=>{
    let A=+document.getElementById(f+"A").value||0;
    let E=+document.getElementById(f+"E").value||0;
    let pct=A+E?Math.round(A/(A+E)*100):0;
    dados[f]=pct;

    let meta=metas[faixa][f];
    document.getElementById("meta"+f).innerText=
      `Meta ${meta}% ‚Ä¢ ${pct<meta?"Abaixo":pct<=meta+5?"Dentro":"Acima"}`;

    let bar=document.getElementById("bar"+f);
    bar.style.width=pct+"%";
    bar.className="progress-bar "+(pct<meta?"pb-red":pct<=meta+5?"pb-yellow":"pb-green");
