<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V√¥lei em Evolu√ß√£o</title>

<style>
:root{
  --primary:#3f51b5;
  --bg:#f2f4f8;
  --card:#ffffff;
  --soft:#f7f9ff;
  --radius:14px;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:var(--bg);
}

.app{
  max-width:420px;
  margin:auto;
  min-height:100vh;
  padding:16px;
}

h1,h2{color:var(--primary);}

input,select{
  width:100%;
  padding:10px;
  height:42px;
  border-radius:10px;
  border:1px solid #dcdcdc;
  font-size:14px;
  box-sizing:border-box;
  margin-top:6px;
}

button{
  width:100%;
  padding:14px;
  margin-top:14px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:12px;
  font-size:15px;
}

.perfil{
  background:linear-gradient(135deg,#3f51b5,#5c6bc0);
  color:#fff;
  padding:12px;
  border-radius:var(--radius);
  font-size:13px;
  line-height:1.5;
}

.fundamentos{
  display:grid;
  gap:12px;
}

.card{
  background:var(--card);
  padding:12px;
  border-radius:var(--radius);
  box-shadow:0 4px 10px rgba(0,0,0,.05);
}

.grid-inputs{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}

.progress{
  height:8px;
  background:#e0e4f5;
  border-radius:8px;
  overflow:hidden;
  margin-top:8px;
}

.progress-bar{
  height:100%;
  width:0%;
  transition:width .8s ease;
}

.pb-red{background:#d32f2f;}
.pb-yellow{background:#f9a825;}
.pb-green{background:#388e3c;}

.resultado{
  background:var(--soft);
  padding:12px;
  border-radius:var(--radius);
  margin-top:12px;
  font-size:13px;
}

.meta{
  font-size:12px;
  margin-top:6px;
}

canvas{
  margin-top:12px;
  background:#fff;
  border-radius:var(--radius);
}

.oculto{display:none;}
</style>
</head>

<body>
<div class="app">

<!-- LOGIN -->
<div id="login">
  <h1>üèê V√¥lei em Evolu√ß√£o</h1>

  <input id="nome" placeholder="Nome do atleta">
  <input id="idade" type="number" placeholder="Idade">
  <input id="altura" type="number" step="0.01" placeholder="Altura (m)">
  <input id="peso" type="number" step="0.1" placeholder="Peso (kg)">
  <input id="quadril" type="number" step="0.1" placeholder="Quadril (cm)">

  <select id="genero">
    <option value="">G√™nero</option>
    <option>Feminino</option>
    <option>Masculino</option>
  </select>

  <select id="posicao">
    <option value="">Posi√ß√£o</option>
    <option>Levantador(a)</option>
    <option>Ponteiro(a)</option>
    <option>Central</option>
    <option>Oposto(a)</option>
    <option>L√≠bero</option>
  </select>

  <button onclick="entrar()">Entrar como atleta</button>
  <button onclick="abrirTreinador()">Entrar como treinador</button>
</div>

<!-- APP ATLETA -->
<div id="app" class="oculto">

<div class="perfil">
<strong>Atleta:</strong> <span id="pNome"></span><br>
<strong>Idade:</strong> <span id="pIdade"></span> ¬∑
<strong>G√™nero:</strong> <span id="pGenero"></span><br>
<strong>Posi√ß√£o:</strong> <span id="pPosicao"></span><br>
<strong>IMC:</strong> <span id="pIMC"></span> (<span id="statusIMC"></span>)<br>
<strong>IAC:</strong> <span id="pIAC"></span> (<span id="statusIAC"></span>)
</div>

<h2>Fundamentos</h2>

<div class="fundamentos">
  <div class="card"><strong>Saque</strong>
    <div class="grid-inputs">
      <input id="SaqueA" type="number" placeholder="Acertos">
      <input id="SaqueE" type="number" placeholder="Erros">
    </div>
    <div class="progress"><div id="barSaque" class="progress-bar"></div></div>
    <div id="metaSaque" class="meta"></div>
  </div>

  <div class="card"><strong>Passe</strong>
    <div class="grid-inputs">
      <input id="PasseA" type="number" placeholder="Acertos">
      <input id="PasseE" type="number" placeholder="Erros">
    </div>
    <div class="progress"><div id="barPasse" class="progress-bar"></div></div>
    <div id="metaPasse" class="meta"></div>
  </div>

  <div class="card"><strong>Ataque</strong>
    <div class="grid-inputs">
      <input id="AtaqueA" type="number" placeholder="Acertos">
      <input id="AtaqueE" type="number" placeholder="Erros">
    </div>
    <div class="progress"><div id="barAtaque" class="progress-bar"></div></div>
    <div id="metaAtaque" class="meta"></div>
  </div>

  <div class="card"><strong>Defesa</strong>
    <div class="grid-inputs">
      <input id="DefesaA" type="number" placeholder="Acertos">
      <input id="DefesaE" type="number" placeholder="Erros">
    </div>
    <div class="progress"><div id="barDefesa" class="progress-bar"></div></div>
    <div id="metaDefesa" class="meta"></div>
  </div>
</div>

<button onclick="analisar()">Analisar Sess√£o</button>

<div id="saida"></div>

<h2>Dashboard</h2>
<canvas id="grafico" width="360" height="180"></canvas>

<button onclick="toggleHistorico()">üìà Ver hist√≥rico</button>
<canvas id="graficoHistorico" width="360" height="180" class="oculto"></canvas>

<button onclick="gerarPDF()">üìÑ Gerar PDF</button>
<button onclick="sair()">Sair</button>
</div>

<!-- MODO TREINADOR -->
<div id="treinador" class="oculto">
  <h2>üë®‚Äçüè´ Modo Treinador</h2>
  <div id="listaAtletas"></div>
  <button onclick="voltarLogin()">Voltar</button>
</div>

</div>

<script>
let atletaAtual=null;

/* ===== METAS E TREINOS ===== */
function faixaEtaria(idade){
  if(idade<=12) return "infantil";
  if(idade<=15) return "juvenil";
  return "adulto";
}

const metas={
  infantil:{Saque:50,Passe:60,Ataque:50,Defesa:60},
  juvenil:{Saque:60,Passe:70,Ataque:65,Defesa:70},
  adulto:{Saque:70,Passe:80,Ataque:75,Defesa:75}
};

const treinos={
  infantil:{
    Saque:["Alvo grande","Controle","Rotina simples"],
    Passe:["Passe parado","Coordena√ß√£o","Precis√£o"],
    Ataque:["Sem salto","Tempo de bola","Coordena√ß√£o"],
    Defesa:["Posicionamento","Rea√ß√£o","Base"]
  },
  juvenil:{
    Saque:["Saque direcionado","Regularidade","Ritmo"],
    Passe:["Passe em movimento","Leitura","Precis√£o"],
    Ataque:["Tempo de ataque","Coordena√ß√£o","Efici√™ncia"],
    Defesa:["Rea√ß√£o","Posicionamento","Transi√ß√£o"]
  },
  adulto:{
    Saque:["Saque t√°tico","Alvo espec√≠fico","Press√£o"],
    Passe:["Passe sob press√£o","Decis√£o","Qualidade"],
    Ataque:["Varia√ß√£o","Efici√™ncia","Decis√£o"],
    Defesa:["Leitura","Rea√ß√£o","Continuidade"]
  }
};

/* ===== LOGIN ===== */
function entrar(){
  atletaAtual = nome.value;
  if(!atletaAtual) return alert("Informe o nome");

  let atleta={
    perfil:{
      nome:nome.value,
      idade:+idade.value,
      genero:genero.value,
      posicao:posicao.value,
      altura:+altura.value,
      peso:+peso.value,
      quadril:+quadril.value
    },
    sessoes:[]
  };

  localStorage.setItem(atletaAtual,JSON.stringify(atleta));
  carregarPerfil();

  login.classList.add("oculto");
  app.classList.remove("oculto");
}

function carregarPerfil(){
  let a=JSON.parse(localStorage.getItem(atletaAtual));
  pNome.innerText=a.perfil.nome;
  pIdade.innerText=a.perfil.idade;
  pGenero.innerText=a.perfil.genero;
  pPosicao.innerText=a.perfil.posicao;

  let imc=(a.perfil.peso/(a.perfil.altura**2)).toFixed(1);
  let iac=((a.perfil.quadril/(a.perfil.altura*Math.sqrt(a.perfil.altura)))-18).toFixed(1);

  pIMC.innerText=imc;
  pIAC.innerText=iac;

  statusIMC.innerText=imc<18.5?"Abaixo":imc<=24.9?"Ideal":"Acima";
  statusIAC.innerText=iac<=30?"Ideal":"Acima";
}

/* ===== AN√ÅLISE ===== */
function analisar(){
  let atleta=JSON.parse(localStorage.getItem(atletaAtual));
  let faixa=faixaEtaria(atleta.perfil.idade);

  let fundamentos=["Saque","Passe","Ataque","Defesa"];
  let dados={};

  fundamentos.forEach(f=>{
    let A=+document.getElementById(f+"A").value||0;
    let E=+document.getElementById(f+"E").value||0;
    let pct=A+E?Math.round(A/(A+E)*100):0;
    dados[f]=pct;

    let meta=metas[faixa][f];
    document.getElementById("meta"+f).innerText=
      `Meta ${meta}% ‚Ä¢ ${pct<meta?"Abaixo":pct<=meta+5?"Dentro":"Acima"}`;

    let bar=document.getElementById("bar"+f);
    bar.style.width=pct+"%";
    bar.className="progress-bar "+(pct<meta?"pb-red":pct<=meta+5?"pb-yellow":"pb-green");
  });

  atleta.sessoes.push({data:new Date().toLocaleString(),fundamentos:dados});
  localStorage.setItem(atletaAtual,JSON.stringify(atleta));

  let pior=Object.entries(dados).sort((a,b)=>a[1]-b[1])[0][0];
  saida.innerHTML=`
    <div class="resultado">
      üìã <strong>Treino sugerido (${pior})</strong><br>
      ${treinos[faixa][pior].map(t=>"‚Ä¢ "+t).join("<br>")}
    </div>`;

  desenharDashboard(dados);
}

/* ===== DASHBOARD ===== */
function desenharDashboard(d){
  let ctx=grafico.getContext("2d");
  ctx.clearRect(0,0,360,180);
  let i=0;
  for(let f in d){
    let h=d[f]*1.4;
    ctx.fillStyle="#3f51b5";
    ctx.fillRect(30+i*80,160-h,46,h);
    ctx.fillText(f,30+i*80,175);
    ctx.fillText(d[f]+"%",34+i*80,145-h);
    i++;
  }
}

/* ===== HIST√ìRICO ===== */
function toggleHistorico(){
  graficoHistorico.classList.toggle("oculto");
  let atleta=JSON.parse(localStorage.getItem(atletaAtual));
  let ctx=graficoHistorico.getContext("2d");
  ctx.clearRect(0,0,360,180);

  atleta.sessoes.forEach((s,i)=>{
    let m=Object.values(s.fundamentos).reduce((a,b)=>a+b,0)/4;
    let h=m*1.4;
    ctx.fillStyle="#9fa8da";
    ctx.fillRect(20+i*40,160-h,30,h);
    ctx.fillText(Math.round(m)+"%",22+i*40,155-h);
  });
}

function gerarPDF(){window.print();}
function sair(){app.classList.add("oculto");login.classList.remove("oculto");}
function voltarLogin(){treinador.classList.add("oculto");login.classList.remove("oculto");}
function abrirTreinador(){
  login.classList.add("oculto");
  treinador.classList.remove("oculto");
  let html="";
  for(let k in localStorage){
    try{
      let a=JSON.parse(localStorage.getItem(k));
      if(a?.perfil){
        html+=`<div class="card"><strong>${a.perfil.nome}</strong><br>${a.perfil.posicao}</div>`;
      }
    }catch{}
  }
  listaAtletas.innerHTML=html;
}
</script>
</body>
</html>
