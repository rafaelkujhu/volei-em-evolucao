<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V√¥lei em Evolu√ß√£o</title>

<style>
:root{
  --primary:#3f51b5;
  --bg:#f2f4f8;
  --card:#ffffff;
  --radius:14px;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:var(--bg);
}

.app{
  max-width:420px;
  margin:auto;
  min-height:100vh;
  padding:16px;
}

h1,h2{color:var(--primary);}

input,select{
  width:100%;
  padding:10px;
  height:42px;
  border-radius:10px;
  border:1px solid #dcdcdc;
  font-size:14px;
  margin-top:6px;
}

button{
  width:100%;
  padding:14px;
  margin-top:14px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:12px;
}

.card{
  background:#fff;
  padding:12px;
  border-radius:14px;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
  margin-top:12px;
}

.progress{
  height:8px;
  background:#e0e4f5;
  border-radius:8px;
  overflow:hidden;
  margin-top:6px;
}

.progress-bar{height:100%;width:0%;}
.pb-red{background:#d32f2f;}
.pb-yellow{background:#f9a825;}
.pb-green{background:#388e3c;}

canvas{margin-top:12px;background:#fff;border-radius:14px;}
.oculto{display:none;}

@media print{
  button,#login,#treinador{display:none;}
}
</style>
</head>

<body>
<div class="app">

<!-- LOGIN -->
<div id="login">
  <h1>üèê V√¥lei em Evolu√ß√£o</h1>
  <input id="nome" placeholder="Nome">
  <input id="idade" type="number" placeholder="Idade">
  <select id="posicao">
    <option value="">Posi√ß√£o</option>
    <option>Levantador(a)</option>
    <option>Ponteiro(a)</option>
    <option>Central</option>
    <option>Oposto(a)</option>
    <option>L√≠bero</option>
  </select>
  <button onclick="entrar()">Entrar como atleta</button>
  <button onclick="abrirTreinador()">Entrar como treinador</button>
</div>

<!-- APP ATLETA -->
<div id="app" class="oculto">
  <h2 id="perfil"></h2>

  <!-- FUNDAMENTOS -->
  <div id="fundamentos"></div>

  <button onclick="analisar()">Analisar sess√£o</button>

  <div id="saida"></div>

  <canvas id="grafico" width="360" height="180"></canvas>

  <button onclick="gerarPDF()">üìÑ PDF pedag√≥gico</button>
  <button onclick="sair()">Sair</button>
</div>

<!-- TREINADOR -->
<div id="treinador" class="oculto">
  <h2>Modo treinador</h2>
  <div id="listaAtletas"></div>
  <canvas id="graficoAtleta" width="360" height="180"></canvas>
  <button onclick="voltarLogin()">Voltar</button>
</div>

</div>

<script>
let atletaAtual=null;

/* ===== CONFIGURA√á√ÉO DE FUNDAMENTOS ===== */
const fundamentos = ["Saque","Passe","Ataque","Defesa"];

/* ===== LOGIN ===== */
function entrar(){
  if(!nome.value.trim()){
    alert("Informe o nome");
    return;
  }
  atletaAtual = nome.value.trim();

  let atleta = {
    perfil:{
      nome:atletaAtual,
      idade:Number(idade.value)||0,
      posicao:posicao.value||""
    },
    sessoes:[]
  };

  localStorage.setItem(atletaAtual, JSON.stringify(atleta));
  login.classList.add("oculto");
  app.classList.remove("oculto");
  perfil.innerText = `${atleta.perfil.nome} (${atleta.perfil.posicao})`;

  montarFundamentos();
}

/* ===== MONTA UI DOS FUNDAMENTOS ===== */
function montarFundamentos(){
  let html="";
  fundamentos.forEach(f=>{
    html+=`
      <div class="card">
        <strong>${f}</strong>
        <input id="${f}A" type="number" placeholder="Acertos">
        <input id="${f}E" type="number" placeholder="Erros">
        <div class="progress">
          <div id="bar${f}" class="progress-bar"></div>
        </div>
      </div>`;
  });
  document.getElementById("fundamentos").innerHTML = html;
}

/* ===== AN√ÅLISE ===== */
function analisar(){
  let atleta = JSON.parse(localStorage.getItem(atletaAtual));
  if(!atleta) return;

  let dados = {};
  fundamentos.forEach(f=>{
    let A = Number(document.getElementById(f+"A").value)||0;
    let E = Number(document.getElementById(f+"E").value)||0;
    let pct = (A+E)?Math.round(A/(A+E)*100):0;
    dados[f]=pct;

    let bar = document.getElementById("bar"+f);
    bar.style.width = pct+"%";
    bar.className =
      "progress-bar "+(pct<60?"pb-red":pct<80?"pb-yellow":"pb-green");
  });

  atleta.sessoes.push({fundamentos:dados});
  localStorage.setItem(atletaAtual, JSON.stringify(atleta));

  saida.innerHTML = "Sess√£o registrada com sucesso";
  desenharGrafico(dados);
}

/* ===== DASHBOARD ===== */
function desenharGrafico(dados){
  let ctx = grafico.getContext("2d");
  ctx.clearRect(0,0,360,180);
  fundamentos.forEach((f,i)=>{
    let h = dados[f]*1.4;
    ctx.fillStyle="#3f51b5";
    ctx.fillRect(30+i*70,160-h,40,h);
    ctx.fillText(f,30+i*70,175);
  });
}

/* ===== PDF ===== */
function gerarPDF(){ window.print(); }

/* ===== TREINADOR ===== */
function abrirTreinador(){
  login.classList.add("oculto");
  treinador.classList.remove("oculto");

  let html="";
  for(let k in localStorage){
    try{
      let a=JSON.parse(localStorage.getItem(k));
      if(a?.perfil){
        html+=`<div class="card" onclick="mostrarGrafico('${k}')">${a.perfil.nome}</div>`;
      }
    }catch{}
  }
  listaAtletas.innerHTML = html || "<div class='card'>Nenhum atleta</div>";
}

function mostrarGrafico(nome){
  let a = JSON.parse(localStorage.getItem(nome));
  if(!a || !a.sessoes.length) return;

  let ctx = graficoAtleta.getContext("2d");
  ctx.clearRect(0,0,360,180);

  a.sessoes.forEach((s,i)=>{
    let media = Object.values(s.fundamentos).reduce((x,y)=>x+y,0)/fundamentos.length;
    let h = media*1.4;
    ctx.fillStyle="#7986cb";
    ctx.fillRect(30+i*40,160-h,30,h);
  });
}

/* ===== VOLTAR ===== */
function sair(){
  app.classList.add("oculto");
  login.classList.remove("oculto");
}
function voltarLogin(){
  treinador.classList.add("oculto");
  login.classList.remove("oculto");
}
</script>
</body>
</html>
